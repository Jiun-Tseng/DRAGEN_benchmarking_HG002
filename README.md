# Genomic Variant Benchmarking and Analysis

This repository contains pipelines and analysis scripts for benchmarking and evaluating genomic variant calling performance across multiple variant classes, including SNPs, INDELs, structural variants (SVs), and copy number variants (CNVs). It integrates **command-line benchmarking pipelines**, **statistical comparison methods**, and **visualization workflows** to support  assessment of variant calling experiments.

The repository is organized into modular subdirectories, each with its own focused README and analysis scope.

---

## Repository Structure

```
.
├── truvari-benchmarking/          # Structural variant benchmarking with Truvari
├── benchmarking-visualization/    # R scripts for SNP/INDEL and SV/CNV visualization
├── bland-altman-analysis/         # Bland–Altman statistical comparison of metrics
└── README.md                      # Current file
```

---

## Components

### 1. Truvari Benchmarking Pipeline

A bash pipeline for benchmarking structural variants using [Truvari]. This pipeline

* Prepares and indexes the GRCh38 reference genome
* Normalizes and cleans both GIAB HG002 benchmark VCFs and sample VCFs
* Filters genomic regions using BED exclusion files
* Runs Truvari to compute performance metrics
* Outputs categorized VCFs and summary statistics (TP, FP, FN, genotype mismatches)
* Optionally uploads results to Google Cloud Storage

See `truvari-benchmarking/README.md` for full requirements, inputs, outputs, and usage instructions.

---

### 2. Benchmarking Visualization (SNP/INDEL and SV/CNV)

R scripts for processing and visualizing benchmarking metrics from TSV outputs generated by variant calling and benchmarking tools. This script inclues: 

* **SNP & INDEL benchmarking visualization**

  * Precision, Recall, and F1 Score
  * Filtering by experiment, coverage, and sample
  * Generation of per-variant-type and combined plots

* **SV & CNV benchmarking visualization**

  * Metrics including TP, FP, FN, Precision, Recall, F1 Score, and Coverage
  * Bar plots and optional trend visualizations across replicates

Plots are saved as PNG files for downstream reporting and comparison.

See `benchmarking-visualization/README.md` for script-level details and usage.

---

### 3. Bland–Altman Summary Statistics

R based statistical analysis for comparing benchmarking metrics between two experimental conditions using Bland–Altman analysis. The script analyzes standard seqeuncing metrics such as Precision, Recall, F1 Scor. This analysis

* Combines long-format SNP and INDEL benchmarking results
* Filters for selected experimental conditions
* Reshapes metrics into wide format for paired comparison
* Computes bias, limits of agreement (LoA), confidence intervals, and hypothesis tests
* Outputs summary statistics as CSV files for downstream interpretation

See `bland-altman-analysis/README.md` for methodology and execution details.

---

## Intended Use

This repository is designed for:

* Evaluating and comparing variant calling experiments
* Benchmarking against GIAB truth sets
* Statistical comparison of performance metrics across experimental conditions
* Generating publication- or report-ready visualizations

It is suitable for research, development, and validation workflows in genomics and bioinformatics.

---

## Dependencies

Depending on the submodule, the repository uses:

* **Bash tools:** samtools, bcftools, GATK, Truvari, gsutil
* **R packages:** dplyr, tidyr, ggplot2, patchwork, stringr, readr, blandr

Refer to each subdirectory README for exact dependency requirements.

---

## Notes

* Each subdirectory is self-contained and can be used independently.
* Paths, file names, and cloud destinations should be configured by the user.
* Outputs are intended to integrate into downstream QC, reporting, or comparative analyses.

